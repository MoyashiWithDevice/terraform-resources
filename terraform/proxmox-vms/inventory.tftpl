[proxmox_vms]
%{ for vm in vms ~}
%{ for ip in flatten(vm.ipv4_addresses) ~}
%{ if ip != "127.0.0.1" && ip != "" ~}
${vm.name} ansible_host=${ip}
%{ break ~} # 最初の有効なIPが見つかったら終了
%{ endif ~}
%{ endfor ~}
%{ endfor ~}

[all:vars]
ansible_user=ansible
ansible_python_interpreter=/usr/bin/python3
ansible_ssh_common_args='-o StrictHostKeyChecking=no'
